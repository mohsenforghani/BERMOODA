<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bermooda - Mohsen Forghani</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    height: 100%;
    touch-action: none;
  }

  canvas {
    display: block;
    background: black;
  }

  #startBtn {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 32px;
    padding: 15px 50px;
    background: yellow;
    color: black;
    border: none;
    border-radius: 15px;
    font-weight: bold;
    z-index: 10;
  }

#creatorName {
    position: absolute;
    bottom: 10px;          /* ÙØ§ØµÙ„Ù‡ Ø§Ø² Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ */
    right: 10px;           /* ÙØ§ØµÙ„Ù‡ Ø§Ø² Ø±Ø§Ø³Øª ØµÙØ­Ù‡ */
    font-size: 10px;       /* Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙÙˆÙ†Øª Ù…Ù†Ø§Ø³Ø¨ */
    color: rgba(255,255,255,0.5); /* Ø´ÙØ§ÙÛŒØª Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø¨Ø§ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ */
    font-style: italic;    /* ÙÙˆÙ†Øª Ø§ÛŒØªØ§Ù„ÛŒÚ© */
    pointer-events: none;  /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù…ØªÙ† */
    z-index: 10;           /* Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ú©Ø§Ù†ÙˆØ§Ø³ Ùˆ Ø¹Ù†Ø§ØµØ± Ø¯ÛŒÚ¯Ø± */
    text-shadow: 0 1px 2px rgba(0,0,0,0.5); /* Ú©Ù…ÛŒ Ø³Ø§ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ø²ÛŒØ¨Ø§ÛŒÛŒ */
    font-family: Arial, sans-serif;
}

  /* ğŸ® Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© */
  #joystick {
    position: absolute;
    bottom: 80px;
    right: 80px;
    width: 140px;
    height: 140px;
    background: rgba(255,255,255,0.1);
    border: 3px solid rgba(255,255,255,0.4);
    border-radius: 50%;
  }

  #stick {
    position: absolute;
    width: 60px;
    height: 60px;
    background: orange;
    border-radius: 50%;
    top: 40px;
    left: 40px;
    transition: 0.05s;
  }

  #shoot {
    position: absolute;
    bottom: 100px;
    left: 40px;
    width: 50px;
    height: 50px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    color: white;
    font-size: 40px;
    text-align: center;
    line-height: 100px;
    user-select: none;
  }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<button id="startBtn">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
<!-- Ù†Ø§Ù… Ø³Ø§Ø²Ù†Ø¯Ù‡ -->
<div id="creatorName">Created by Mohsen Forghani</div>

<!-- ğŸ® Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ -->
<div id="joystick">
  <div id="stick"></div>
</div>
<div id="shoot">ğŸ”¥</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let airplane = { x: canvas.width / 2, y: canvas.height - 120, w: 80, h: 80 };
let bullets = [];
let enemies = [];
let score = 0;
let gameRunning = false;
let dx = 0, dy = 0; // Ø­Ø±Ú©Øª Ù†Ø±Ù… Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§ Ø§Ø² Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©

const airplaneImg = new Image();
airplaneImg.src = "airplane.png"; // Ù…Ø³ÛŒØ± Ø¹Ú©Ø³ Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§
let shootInterval = null;
// Ø´Ø±ÙˆØ¹ Ø´Ù„ÛŒÚ© Ù¾Ø´Øª Ø³Ø± Ù‡Ù… ÙˆÙ‚ØªÛŒ Ø§Ù†Ú¯Ø´Øª Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø´Ø¯
const shootBtn = document.getElementById("shoot");


// === Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ ===
function gameLoop() {
  if (!gameRunning) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Ø­Ø±Ú©Øª Ù†Ø±Ù… Ø¨Ø§ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
  airplane.x += dx * 8;
  airplane.y += dy * 8;
  airplane.x = Math.max(0, Math.min(canvas.width - airplane.w, airplane.x));
  airplane.y = Math.max(0, Math.min(canvas.height - airplane.h, airplane.y));

  // Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§
  ctx.drawImage(airplaneImg, airplane.x, airplane.y, airplane.w, airplane.h);

  // Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
  bullets.forEach((b, i) => {
    b.y -= 10;
    ctx.fillStyle = "yellow";
    ctx.fillRect(b.x, b.y, 5, 10);
    if (b.y < 0) bullets.splice(i, 1);
  });

  // Ø¯Ø´Ù…Ù†â€ŒÙ‡Ø§
  if (Math.random() < 0.03) {
    enemies.push({ x: Math.random() * canvas.width, y: -20, r: 15 });
  }

  enemies.forEach((e, i) => {
    e.y += 2;
    ctx.beginPath();
    ctx.fillStyle = "red";
    ctx.arc(e.x, e.y, e.r, 0, Math.PI * 2);
    ctx.fill();

    // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú¯Ù„ÙˆÙ„Ù‡
    bullets.forEach((b, j) => {
      if (b.x > e.x - e.r && b.x < e.x + e.r && b.y > e.y - e.r && b.y < e.y + e.r) {
        enemies.splice(i, 1);
        bullets.splice(j, 1);
        score += 10;
      }
    });

    // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¯Ø´Ù…Ù† Ø¨Ø§ Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§
    if (Math.abs(e.x - (airplane.x + airplane.w/2)) < e.r + airplane.w/2 &&
        Math.abs(e.y - (airplane.y + airplane.h/2)) < e.r + airplane.h/2) {
        explodeAirplane(); // Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ÙØ¬Ø§Ø±
        endGame();
    }
  });

  // Ø§Ù…ØªÛŒØ§Ø²
  ctx.fillStyle = "white";
  ctx.font = "30px Calibri";
  ctx.fillText("Score: " + score, canvas.width - 180, 50);

  requestAnimationFrame(gameLoop);
}

// === Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ ===
function shoot() {
  if (!gameRunning) return;
  bullets.push({ x: airplane.x + airplane.w / 2, y: airplane.y });
}

function startGame() {
  score = 0;
  airplane.x = canvas.width / 2 - 40;
  airplane.y = canvas.height - 120;
  enemies = [];
  bullets = [];
  gameRunning = true;
  document.getElementById("startBtn").style.display = "none";
  requestAnimationFrame(gameLoop);
}

function endGame() {
  gameRunning = false;
  ctx.fillStyle = "white";
  ctx.font = "80px Times New Roman";
  ctx.fillText("Game Over", canvas.width / 2 - 250, canvas.height / 2);
  document.getElementById("startBtn").style.display = "block";
}

function explodeAirplane() {
  // Ø±Ø³Ù… Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø±Ù…Ø² Ùˆ Ù†Ø§Ø±Ù†Ø¬ÛŒ Ø±ÙˆÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§ Ø¨Ø±Ø§ÛŒ Ú†Ù†Ø¯ ÙØ±ÛŒÙ…
  ctx.fillStyle = "orange";
  ctx.beginPath();
  ctx.arc(airplane.x + airplane.w/2, airplane.y + airplane.h/2, 50, 0, Math.PI*2);
  ctx.fill();
  
  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(airplane.x + airplane.w/2, airplane.y + airplane.h/2, 30, 0, Math.PI*2);
  ctx.fill();
}

// === Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© Ù„Ù…Ø³ÛŒ ===
const joystick = document.getElementById("joystick");
const stick = document.getElementById("stick");
let touchId = null;

joystick.addEventListener("touchstart", e => {
  // Ø§Ú¯Ø± touchId Ù‚Ø¨Ù„Ø§ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯Ù‡ Ø¨ÙˆØ¯ØŒ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ø¨Ú¯ÛŒØ±
  if (touchId !== null) return;
  
  // Ø§ÙˆÙ„ÛŒÙ† Ù„Ù…Ø³ Ø±ÙˆÛŒ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
  const touch = [...e.touches].find(t => {
    const rect = joystick.getBoundingClientRect();
    return t.clientX >= rect.left && t.clientX <= rect.right &&
           t.clientY >= rect.top && t.clientY <= rect.bottom;
  });
  
  if (touch) {
    touchId = touch.identifier;
  }
});

joystick.addEventListener("touchmove", e => {
  if (touchId === null) return;

  // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù„Ù…Ø³ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
  let touch = [...e.touches].find(t => t.identifier === touchId);
  if (!touch) return;

  let rect = joystick.getBoundingClientRect();
  let centerX = rect.left + rect.width / 2;
  let centerY = rect.top + rect.height / 2;

  let tx = touch.clientX - centerX;
  let ty = touch.clientY - centerY;

  const maxDist = 40;
  const distance = Math.sqrt(tx*tx + ty*ty);

  // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø­Ø±Ú©Øª Ø¨Ù‡ Ø¯Ø§ÛŒØ±Ù‡ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
  if (distance > maxDist) {
    tx = tx * maxDist / distance;
    ty = ty * maxDist / distance;
  }

  // Ø­Ø±Ú©Øª Ù†Ø±Ù… stick
  stick.style.transform = `translate(${tx}px, ${ty}px)`;

  // Ù…Ù‚Ø¯Ø§Ø± dx Ùˆ dy Ø¨ÛŒÙ† -1 Ùˆ 1
  dx = tx / maxDist;
  dy = ty / maxDist;
});




joystick.addEventListener("touchend", e => {
  // Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ø¢ÛŒØ§ Ø§ÛŒÙ† Ù„Ù…Ø³ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© Ù…Ø§ Ø¨ÙˆØ¯Ù‡
  const remainingTouches = [...e.touches];
  if (!remainingTouches.find(t => t.identifier === touchId)) {
    // Ù‡ÛŒÚ† Ù„Ù…Ø³ÛŒ Ø§Ø² Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© Ø¨Ø§Ù‚ÛŒ Ù†Ù…ÙˆÙ†Ø¯Ù‡ØŒ Ù¾Ø³ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯ÙˆÙ†ÛŒÙ…
    stick.style.transform = "translate(0, 0)";
    dx = 0;
    dy = 0;
    touchId = null;
  }
});


// === Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ ===
function addTouchAndClick(id, handler) {
  const el = document.getElementById(id);
  el.addEventListener("click", handler);
  el.addEventListener("touchstart", e => { e.preventDefault(); handler(); });
}

addTouchAndClick("startBtn", startGame);
addTouchAndClick("shoot", shoot);

window.addEventListener("resize", () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>

</body>
</html>

