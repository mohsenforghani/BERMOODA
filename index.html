<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bermooda - Mohsen Forghani</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    height: 100%;
    touch-action: none;
  }

  canvas {
    display: block;
    background: black;
  }

  #startBtn {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 20px;
    padding: 20px 60px;
    background: yellow;
    color: black;
    border: none;
    border-radius: 20px;
    font-weight: normal;
    z-index: 10;
  }

  #creatorName {
    position: absolute;
    bottom: 10px;
    right: 10px;
    font-size: 10px;
    color: rgba(255,255,255,0.5);
    font-style: italic;
    pointer-events: none;
    z-index: 10;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    font-family: Arial, sans-serif;
  }

  /* ğŸ® Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© */
  #joystick {
    position: absolute;
    bottom: 30px;
    right: 20px;
    width: 80px;
    height: 80px;
    background: rgba(255,255,255,0.1);
    border: 3px solid rgba(255,255,255,0.4);
    border-radius: 50%;
  }

  #stick {
    position: absolute;
    width: 30px;
    height:30px;
    background: orange;
    border-radius: 50%;
    top: 25px;
    left: 25px;
    transition: 0.05s;
  }

  #shoot {
    position: absolute;
    bottom: 20px;
    left: 20px;
    width: 50px;
    height: 50px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    color: white;
    font-size: 25px;
    text-align: center;
    line-height: 50px;
    user-select: none;
  }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<button id="startBtn">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
<div id="creatorName">Created by Mohsen Forghani</div>

<!-- ğŸ® Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ -->
<div id="joystick">
  <div id="stick"></div>
</div>
<div id="shoot">ğŸ”¥</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let airplane = { x: canvas.width / 2, y: canvas.height - 120, w: 80, h: 80 };
let bullets = [];
let enemies = [];
let score = 0;
let gameRunning = false;
let dx = 0, dy = 0; 
let explosionRunning = false;
let fuel = 100; // Ù…Ù‚Ø¯Ø§Ø± Ø³ÙˆØ®Øª Ø¨ÛŒÙ† 0 ØªØ§ 100
let lastFuelSpawn = Date.now();
let fuels = [];
const airplaneImg = new Image();
airplaneImg.src = "airplane.png"; 
// âœˆï¸ ØªØµØ§ÙˆÛŒØ± Ø¯Ø´Ù…Ù†â€ŒÙ‡Ø§
const enemyImages = [
  "plane1.png",
  "plane2.png",
  "plane3.png",
  "plane4.png",
  "plane6.png",
  "plane8.png",
  "plane10.png",
  "plane12.png",
].map(src => {
  const img = new Image();
  img.src = src;
  return img;
});



let shootInterval = null;
const shootBtn = document.getElementById("shoot");







  // ğŸ¨ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…ØªØ­Ø±Ú© Ø¢Ø³Ù…Ø§Ù†
let clouds = [];
const cloudImages = ["cloud1.png", "cloud2.png", "cloud3.png"].map(src => {
  const img = new Image();
  img.src = src;
  return img;
});

// Ø³Ø§Ø®Øª Ú†Ù†Ø¯ Ø§Ø¨Ø± Ø¨Ø§ Ù…ÙˆÙ‚Ø¹ÛŒØª ØªØµØ§Ø¯ÙÛŒ
for (let i = 0; i < 6; i++) {
  clouds.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    speed: 0.2 + Math.random() * 0.5,
    img: cloudImages[Math.floor(Math.random() * cloudImages.length)],
    size: 60 + Math.random() * 100
  });
}

// Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø±Ùˆ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ÛŒ ØªØ§Ø¨Ø¹ gameLoop Ù‚Ø±Ø§Ø± Ø¨Ø¯Ù‡:
function drawBackground() {
  // Ø¢Ø³Ù…Ø§Ù† Ú¯Ø±Ø§Ø¯ÛŒØ§Ù†ÛŒ
  const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
  grad.addColorStop(0, "#4da6ff"); // Ø¢Ø¨ÛŒ Ø±ÙˆØ´Ù† Ø¨Ø§Ù„Ø§
  grad.addColorStop(1, "#003366"); // Ø¢Ø¨ÛŒ ØªÛŒØ±Ù‡ Ù¾Ø§ÛŒÛŒÙ†
  ctx.fillStyle = grad;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Ø­Ø±Ú©Øª Ùˆ Ø±Ø³Ù… Ø§Ø¨Ø±Ù‡Ø§
  clouds.forEach(c => {
    c.y += c.speed;
    if (c.y > canvas.height + 100) {
      c.y = -100;
      c.x = Math.random() * canvas.width;
    }
    ctx.globalAlpha = 0.5; // Ø´ÙØ§ÙÛŒØª Ø§Ø¨Ø±
    ctx.drawImage(c.img, c.x, c.y, c.size, c.size * 0.6);
    ctx.globalAlpha = 1;
  });
}






  
// === Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ ===
function gameLoop() {
  if (!gameRunning) return;
  
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBackground();
  airplane.x += dx * 8;
  airplane.y += dy * 8;
  airplane.x = Math.max(0, Math.min(canvas.width - airplane.w, airplane.x));
  airplane.y = Math.max(0, Math.min(canvas.height - airplane.h, airplane.y));

  ctx.drawImage(airplaneImg, airplane.x, airplane.y, airplane.w, airplane.h);


// ğŸ”« Ø±Ø³Ù… Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
bullets.forEach((b, i) => {
  b.y -= 10;
  ctx.fillStyle = "yellow";
  ctx.fillRect(b.x - 2, b.y, 4, 10);
  if (b.y < 0) bullets.splice(i, 1);
});

 


 if (Math.random() < 0.015) {
  const padding = 30;
  enemies.push({
    x: Math.random() * (canvas.width - 2 * padding) + padding,
    y: -60,
    w: 70,
    h: 70,
    img: enemyImages[Math.floor(Math.random() * enemyImages.length)]
  });
}


// ØªÙˆÙ„ÛŒØ¯ Ø³ÙˆØ®Øª Ù‡Ø± 20 Ø«Ø§Ù†ÛŒÙ‡
if (Date.now() - lastFuelSpawn > 20000) {
  fuels.push({
    x: Math.random() * (canvas.width - 80) + 40,
    y: -50,
    w: 25,
    h: 60
  });
  lastFuelSpawn = Date.now();
}


enemies.forEach((e, i) => {
  ctx.drawImage(e.img, e.x - e.w / 2, e.y - e.h / 2, e.w, e.h);
  e.y += 2;

  // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ø¯Ø´Ù…Ù†
  bullets.forEach((b, j) => {
    if (
      b.x > e.x - e.w/2 &&
      b.x < e.x + e.w/2 &&
      b.y > e.y - e.h/2 &&
      b.y < e.y + e.h/2
    ) {
      enemies.splice(i, 1);
      bullets.splice(j, 1);
      score += 10;
    }
  });

  // âœ… Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§ Ø¨Ø§ Ø¯Ø´Ù…Ù†
  if (
    airplane.x < e.x + e.w / 2 &&
    airplane.x + airplane.w > e.x - e.w / 2 &&
    airplane.y < e.y + e.h / 2 &&
    airplane.y + airplane.h > e.y - e.h / 2
  ) {
    explodeAirplane();
    endGame();
  }
});




fuels.forEach((f, i) => {
  f.y += 1; // Ø­Ø±Ú©Øª Ù¾Ø§ÛŒÛŒÙ†
  ctx.fillStyle = "orange";
  ctx.fillRect(f.x, f.y, f.w, f.h);

  // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§
  if (
    airplane.x < f.x + f.w &&
    airplane.x + airplane.w > f.x &&
    airplane.y < f.y + f.h &&
    airplane.y + airplane.h > f.y
  ) {
    fuel += 70; // Ø§ÙØ²Ø§ÛŒØ´ Ø³ÙˆØ®Øª
    if (fuel > 100) fuel = 100;
    fuels.splice(i, 1);
  }

  if (f.y > canvas.height) fuels.splice(i, 1);
});




  ctx.fillStyle="white";
  ctx.font="12px Calibri";
  ctx.fillText("Score: "+score, canvas.width-80,20);


fuel -= 0.05; // Ú©Ø§Ù‡Ø´ ØªØ¯Ø±ÛŒØ¬ÛŒ Ø³ÙˆØ®Øª
if (fuel < 0) {
  fuel = 0;
  endGame();
}





// Ù†ÙˆØ§Ø± Ø³ÙˆØ®Øª Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡
let fuelBarWidth = canvas.width * 0.5; // Ù†ØµÙ Ø¹Ø±Ø¶ ØµÙØ­Ù‡
let fuelX = (canvas.width - fuelBarWidth) / 2; // ÙˆØ³Ø· ØµÙØ­Ù‡
let fuelY = 15; // ÙØ§ØµÙ„Ù‡ Ø§Ø² Ø¨Ø§Ù„Ø§
let fuelHeight = 8;

// ØªØ¹ÛŒÛŒÙ† Ø±Ù†Ú¯ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ÛŒØ²Ø§Ù† Ø³ÙˆØ®Øª
let fuelColor = "lime";
if (fuel < 60) fuelColor = "yellow";
if (fuel < 30) fuelColor = "red";

// Ø²Ù…ÛŒÙ†Ù‡â€ŒÛŒ Ù†ÙˆØ§Ø±
ctx.fillStyle = "rgba(255,255,255,0.2)";
ctx.fillRect(fuelX, fuelY, fuelBarWidth, fuelHeight);

// Ù…Ù‚Ø¯Ø§Ø± ÙØ¹Ù„ÛŒ Ø³ÙˆØ®Øª
ctx.fillStyle = fuelColor;
ctx.fillRect(fuelX, fuelY, (fuel / 100) * fuelBarWidth, fuelHeight);

// Ù‚Ø§Ø¨ Ø¯ÙˆØ± Ù†ÙˆØ§Ø±
ctx.strokeStyle = "white";
ctx.lineWidth = 1;
ctx.strokeRect(fuelX, fuelY, fuelBarWidth, fuelHeight);




  

  requestAnimationFrame(gameLoop);
}

// === Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ ===
function shoot() {
  if(!gameRunning) return;
  bullets.push({x:airplane.x+airplane.w/2,y:airplane.y});
}

function startGame() {
  if (explosionRunning) return; // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ù‚Ø¨Ù„ Ø§Ø² Ù¾Ø§ÛŒØ§Ù† Ø§Ù†ÙØ¬Ø§Ø±
  score = 0;
 fuel = 100; 
  airplane.x = canvas.width / 2 - 40;
  airplane.y = canvas.height - 120;
  enemies = [];
  bullets = [];
  gameRunning = true;
  document.getElementById("startBtn").style.display = "none";
  requestAnimationFrame(gameLoop);
}

function endGame() {
  gameRunning = false;

  // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù‚Ø¨Ù„ Ø§Ø² Ù†Ù…Ø§ÛŒØ´ Ù…ØªÙ†
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Ø°Ø®ÛŒØ±Ù‡ ÙˆØ¶Ø¹ÛŒØª Ù‚Ø¨Ù„ÛŒ
  ctx.save();

  // ØªÙ†Ø¸ÛŒÙ… Ù…ØªÙ† ÙˆØ³Ø· ØµÙØ­Ù‡
  ctx.fillStyle = "white";
  ctx.font = "40px Times New Roman";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText("Game Over", canvas.width / 2, canvas.height / 2.6);

  // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚Ø¨Ù„ÛŒ (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²)
  ctx.restore();

  // Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø¨Ø¹Ø¯ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡ ÙØ¹Ø§Ù„ Ø´ÙˆØ¯
  const startBtn = document.getElementById("startBtn");
  startBtn.style.display = "none";
  setTimeout(() => {
    startBtn.style.display = "block";
  }, 1000);
}


function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas(); // Ø§Ø¬Ø±Ø§ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§



function explodeAirplane() {
  explosionRunning = true;
  if (navigator.vibrate) navigator.vibrate(200);

  const pieces = [];
  const numPieces = 30;

  for (let i = 0; i < numPieces; i++) {
    pieces.push({
      x: airplane.x + airplane.w/2,
      y: airplane.y + airplane.h/2,
      vx: (Math.random() - 0.5) * 12,
      vy: (Math.random() - 0.5) * 12,
      w: Math.random() * 8 + 2,
      h: Math.random() * 8 + 2,
      angle: Math.random() * 2 * Math.PI,
      color: ["orange","red","yellow","gray"][Math.floor(Math.random()*4)]
    });
  }

  let frames = 0;
  function animateExplosion() {
    if (frames > 25) {
      explosionRunning = false;
      return;
    }

    ctx.clearRect(airplane.x-50, airplane.y-50, airplane.w+100, airplane.h+100);

    pieces.forEach(p => {
      p.x += p.vx;
      p.y += p.vy;
      p.vx *= 0.92;
      p.vy *= 0.92;
      p.angle += 0.2;

      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.angle);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    });

    frames++;
    requestAnimationFrame(animateExplosion);
  }

  animateExplosion();
}









// === Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© Ù„Ù…Ø³ÛŒ ===
const joystick = document.getElementById("joystick");
const stick = document.getElementById("stick");
let touchId = null;

joystick.addEventListener("touchstart", e=>{
  if(touchId!==null) return;
  const touch=[...e.touches].find(t=>{
    const rect=joystick.getBoundingClientRect();
    return t.clientX>=rect.left && t.clientX<=rect.right &&
           t.clientY>=rect.top && t.clientY<=rect.bottom;
  });
  if(touch) touchId=touch.identifier;
});

joystick.addEventListener("touchmove", e=>{
  if(touchId===null) return;
  let touch=[...e.touches].find(t=>t.identifier===touchId);
  if(!touch) return;
  let rect=joystick.getBoundingClientRect();
  let centerX=rect.left+rect.width/2;
  let centerY=rect.top+rect.height/2;
  let tx=touch.clientX-centerX;
  let ty=touch.clientY-centerY;
  const maxDist=40;
  const distance=Math.sqrt(tx*tx+ty*ty);
  if(distance>maxDist){
    tx=tx*maxDist/distance;
    ty=ty*maxDist/distance;
  }
  stick.style.transform=`translate(${tx}px,${ty}px)`;
  dx=tx/maxDist;
  dy=ty/maxDist;
});

joystick.addEventListener("touchend", e=>{
  const remaining=[...e.touches];
  if(!remaining.find(t=>t.identifier===touchId)){
    stick.style.transform="translate(0,0)";
    dx=0; dy=0; touchId=null;
  }
});

// === Ø´Ù„ÛŒÚ© Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† ===
shootBtn.addEventListener("touchstart", e=>{
  if(!gameRunning) return;
  shoot(); 
  shootInterval=setInterval(shoot,110);
});
shootBtn.addEventListener("touchend", e=>{
  clearInterval(shootInterval);
});



// === Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ ===
function addTouchAndClick(id, handler){
  const el=document.getElementById(id);
  el.addEventListener("click",handler);
  el.addEventListener("touchstart",e=>{e.preventDefault(); handler();});
}

addTouchAndClick("startBtn",startGame);
addTouchAndClick("shoot",shoot);

window.addEventListener("resize",()=>{
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
});
</script>

</body>
</html>






