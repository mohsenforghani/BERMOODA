<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bermooda - Mohsen Forghani</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    height: 100%;
    touch-action: none;
  }

  canvas {
    display: block;
    background: black;
  }

  #startBtn {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 20px;
    padding: 20px 60px;
    background: yellow;
    color: black;
    border: none;
    border-radius: 20px;
    font-weight: normal;
    z-index: 10;
  }

  #creatorName {
    position: absolute;
    bottom: 10px;
    right: 10px;
    font-size: 10px;
    color: rgba(255,255,255,0.5);
    font-style: italic;
    pointer-events: none;
    z-index: 10;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    font-family: Arial, sans-serif;
  }

  /* ðŸŽ® Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© */
  #joystick {
    position: absolute;
    bottom: 30px;
    right: 20px;
    width: 70px;
    height: 70px;
    background: rgba(255,255,255,0.1);
    border: 3px solid rgba(255,255,255,0.4);
    border-radius: 50%;
  }

  #stick {
    position: absolute;
    width: 30px;
    height: 30px;
    background: orange;
    border-radius: 50%;
    top: 20px;
    left: 20px;
    transition: 0.05s;
  }

  #shoot {
    position: absolute;
    bottom: 20px;
    left: 20px;
    width: 50px;
    height: 50px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    color: white;
    font-size: 25px;
    text-align: center;
    line-height: 50px;
    user-select: none;
  }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<button id="startBtn">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
<div id="creatorName">Created by Mohsen Forghani</div>

<!-- ðŸŽ® Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ -->
<div id="joystick">
  <canvas id="joystickTextCanvas" width="70" height="70" style="position:absolute; top:0; left:0; pointer-events:none;"></canvas>
  <div id="stick"></div>
</div>
<div id="shoot">ðŸ”¥</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let airplane = { x: canvas.width / 2, y: canvas.height - 120, w: 80, h: 80 };
let bullets = [];
let enemies = [];
let score = 0;
let gameRunning = false;
let dx = 0, dy = 0; 

const airplaneImg = new Image();
airplaneImg.src = "airplane.png"; 
let shootInterval = null;
const shootBtn = document.getElementById("shoot");

// === Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ ===
function gameLoop() {
  if (!gameRunning) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  airplane.x += dx * 8;
  airplane.y += dy * 8;
  airplane.x = Math.max(0, Math.min(canvas.width - airplane.w, airplane.x));
  airplane.y = Math.max(0, Math.min(canvas.height - airplane.h, airplane.y));

  ctx.drawImage(airplaneImg, airplane.x, airplane.y, airplane.w, airplane.h);

  bullets.forEach((b,i)=>{
    b.y -= 10;
    ctx.fillStyle="yellow";
    ctx.fillRect(b.x,b.y,5,10);
    if(b.y<0) bullets.splice(i,1);
  });

  if(Math.random()<0.03) enemies.push({x:Math.random()*canvas.width,y:-20,r:15});

  enemies.forEach((e,i)=>{
    e.y+=2;
    ctx.beginPath();
    ctx.fillStyle="red";
    ctx.arc(e.x,e.y,e.r,0,Math.PI*2);
    ctx.fill();

    bullets.forEach((b,j)=>{
      if(b.x>e.x-e.r && b.x<e.x+e.r && b.y>e.y-e.r && b.y<e.y+e.r){
        enemies.splice(i,1);
        bullets.splice(j,1);
        score+=10;
      }
    });

    if(Math.abs(e.x-(airplane.x+airplane.w/2))<e.r+airplane.w/2 &&
       Math.abs(e.y-(airplane.y+airplane.h/2))<e.r+airplane.h/2){
        explodeAirplane(); 
        endGame();
    }
  });

  ctx.fillStyle="white";
  ctx.font="30px Calibri";
  ctx.fillText("Score: "+score, canvas.width-180,50);

  requestAnimationFrame(gameLoop);
}

// === Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ ===
function shoot() {
  if(!gameRunning) return;
  bullets.push({x:airplane.x+airplane.w/2,y:airplane.y});
}

function startGame() {
  score=0;
  airplane.x = canvas.width/2-40;
  airplane.y = canvas.height-120;
  enemies=[];
  bullets=[];
  gameRunning=true;
  document.getElementById("startBtn").style.display="none";
  requestAnimationFrame(gameLoop);
}

function endGame() {
  gameRunning=false;
  ctx.fillStyle="white";
  ctx.font="80px Times New Roman";
  ctx.fillText("Game Over", canvas.width/2-250, canvas.height/2);
  document.getElementById("startBtn").style.display="block";
}

function explodeAirplane() {
  ctx.fillStyle="orange";
  ctx.beginPath();
  ctx.arc(airplane.x+airplane.w/2, airplane.y+airplane.h/2,50,0,Math.PI*2);
  ctx.fill();
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(airplane.x+airplane.w/2, airplane.y+airplane.h/2,30,0,Math.PI*2);
  ctx.fill();
}

// === Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© Ù„Ù…Ø³ÛŒ ===
const joystick = document.getElementById("joystick");
const stick = document.getElementById("stick");
let touchId = null;

joystick.addEventListener("touchstart", e=>{
  if(touchId!==null) return;
  const touch=[...e.touches].find(t=>{
    const rect=joystick.getBoundingClientRect();
    return t.clientX>=rect.left && t.clientX<=rect.right &&
           t.clientY>=rect.top && t.clientY<=rect.bottom;
  });
  if(touch) touchId=touch.identifier;
});

joystick.addEventListener("touchmove", e=>{
  if(touchId===null) return;
  let touch=[...e.touches].find(t=>t.identifier===touchId);
  if(!touch) return;
  let rect=joystick.getBoundingClientRect();
  let centerX=rect.left+rect.width/2;
  let centerY=rect.top+rect.height/2;
  let tx=touch.clientX-centerX;
  let ty=touch.clientY-centerY;
  const maxDist=40;
  const distance=Math.sqrt(tx*tx+ty*ty);
  if(distance>maxDist){
    tx=tx*maxDist/distance;
    ty=ty*maxDist/distance;
  }
  stick.style.transform=`translate(${tx}px,${ty}px)`;
  dx=tx/maxDist;
  dy=ty/maxDist;
});

joystick.addEventListener("touchend", e=>{
  const remaining=[...e.touches];
  if(!remaining.find(t=>t.identifier===touchId)){
    stick.style.transform="translate(0,0)";
    dx=0; dy=0; touchId=null;
  }
});

// === Ø´Ù„ÛŒÚ© Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† ===
shootBtn.addEventListener("touchstart", e=>{
  if(!gameRunning) return;
  shoot(); 
  shootInterval=setInterval(shoot,200);
});
shootBtn.addEventListener("touchend", e=>{
  clearInterval(shootInterval);
});

// === Ù…ØªÙ† Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§ÛŒ Ø±ÙˆÛŒ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© ===
const jtCanvas=document.getElementById("joystickTextCanvas");
const jtCtx=jtCanvas.getContext("2d");
const radius = jtCanvas.width/2 - 5;
const text = "Mehrad Game";
const angleStep = (2*Math.PI)/(text.length*1.5);

jtCtx.font="10px Arial";
jtCtx.fillStyle="white";
jtCtx.textAlign="center";
jtCtx.textBaseline="middle";

for(let i=0;i<text.length;i++){
  const char=text[i];
  const angle=-Math.PI/2 + i*angleStep;
  const x=jtCanvas.width/2 + radius*Math.cos(angle);
  const y=jtCanvas.height/2 + radius*Math.sin(angle);
  jtCtx.save();
  jtCtx.translate(x,y);
  jtCtx.rotate(angle+Math.PI/2);
  jtCtx.fillText(char,0,0);
  jtCtx.restore();
}

// === Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ ===
function addTouchAndClick(id, handler){
  const el=document.getElementById(id);
  el.addEventListener("click",handler);
  el.addEventListener("touchstart",e=>{e.preventDefault(); handler();});
}

addTouchAndClick("startBtn",startGame);
addTouchAndClick("shoot",shoot);

window.addEventListener("resize",()=>{
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
});
</script>

</body>
</html>
